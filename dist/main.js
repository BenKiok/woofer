(()=>{"use strict";const e=(()=>{const e=(e,t)=>{e.ref("/Woofs/").once("value",(e=>{t(e.val())}))};function t(t){const a=t.querySelector(".interact"),l=t.querySelector("h3"),d=t.querySelector("h4");let c,s;if(a){let e;a.childNodes[0].addEventListener("click",(()=>{const t=a.parentNode.parentNode;let o=Array.from(t.parentNode.querySelectorAll(".woof.border:not(#reply)")).indexOf(t);document.querySelector("#reply")&&document.querySelector("#reply").remove(),e===o?e=null:(t.parentNode.insertBefore((()=>{const e=document.createElement("div"),t=document.createElement("span"),o=document.createElement("div"),r=document.createElement("input"),n=document.createElement("div"),a=document.createElement("button");e.id="reply",e.classList.add("woof","border"),t.classList.add("avatar"),o.classList.add("content"),r.type="text",r.placeholder="Type your response...",r.classList.add("text"),r.id="input",n.classList.add("more"),a.innerText="Woof",a.classList.add("click");for(let e=0;e<5;e++){const t=document.createElement("i");t.classList.add("click","fas",0==e?"fa-camera":1==e?"fa-image":2==e?"fa-chart-bar":3==e?"fa-smile":4==e?"fa-calendar-alt":""),n.appendChild(t)}return n.appendChild(a),o.append(r,n),e.append(t,o),e})(),Array.from(t.parentNode.querySelectorAll(".woof.border"))[o+1]),e=o,document.querySelector("#reply button").addEventListener("click",(()=>{firebase.database().ref("Woofs/").once("value",(e=>{const o=e.val(),n=t.querySelector("h4"),a=t.querySelector("h3");let l;for(const e in o)if(`${new Date(o[e].time)}`.slice(4,15)==n.innerText&&o[e].text==a.innerText){l=o[e];break}const d={text:document.querySelector("#reply input").value,rewoof:0,fav:0};((e,t,o)=>{let r=e.id;return!("object"!=typeof e||!e||"object"!=typeof t||!t||(t.time=(new Date).getTime(),e.nextWoof?(e.nextWoof.push(t),"focus"===o.id&&console.log("Appending reply...")):e.nextWoof=[t],o.querySelector("span .inline")&&(o.querySelector("span .inline").innerText=e.nextWoof.length),firebase.database().ref("/Woofs/"+r).update(e),0))})(l,d,t)?(document.querySelector("#reply").remove(),l.nextWoof.push(d),r(l.nextWoof,l.nextWoof.indexOf(d),!0)):console.log("Error, could not append reply.")}))})))})),a.childNodes[1].addEventListener("click",(()=>{firebase.database().ref("Woofs/").once("value",(e=>{const t=e.val();let o;for(const e in t)if(`${new Date(t[e].time)}`.slice(4,15)==d.innerText&&t[e].text==l.innerText){o=t[e];break}o?(c?(o.rewoof--,a.querySelectorAll("i")[1].classList.remove("rewoof")):(o.rewoof++,a.querySelectorAll("i")[1].classList.add("rewoof")),c=!c,a.parentNode.parentNode.id?a.parentNode.querySelectorAll(".inline")[0].innerText=o.rewoof+" Rewoof"+(1===o.rewoof?"":"s"):a.querySelectorAll(".inline")[1].innerText=o.rewoof,firebase.database().ref("Woofs/"+o.id).update(o)):alert("Error, could not find wolf.")}))})),a.childNodes[2].addEventListener("click",(()=>{firebase.database().ref("Woofs/").once("value",(e=>{const t=e.val();let o;for(const e in t)if(`${new Date(t[e].time)}`.slice(4,15)==d.innerText&&t[e].text==l.innerText){o=t[e];break}o?(s?(o.fav--,a.querySelectorAll("i")[2].classList.remove("fav")):(o.fav++,a.querySelectorAll("i")[2].classList.add("fav")),s=!s,a.parentNode.parentNode.id?a.parentNode.querySelectorAll(".inline")[1].innerText=o.fav+" Like"+(1===o.fav?"":"s"):a.querySelectorAll(".inline")[2].innerText=o.fav,firebase.database().ref("Woofs/"+o.id).update(o)):alert("Error, could not find wolf.")}))}))}t.querySelector(".text").addEventListener("click",(()=>{if(n(t,t.parentNode),t.id="focus",t.parentNode.querySelector(".woofbox").classList.add("vanish"),t.parentNode.querySelector(".woofbox").classList.remove("woof"),t.parentNode.querySelector(".break").classList.add("vanish"),!t.parentNode.querySelector("#head i")){const r=document.createElement("i");r.classList.add("fas","fa-arrow-left"),r.addEventListener("click",(()=>{t.parentNode.querySelector(".woofbox").classList.remove("vanish"),t.parentNode.querySelector(".woofbox").classList.add("woof"),t.parentNode.querySelector(".break").classList.remove("vanish"),t.parentNode.querySelector("h1").innerText="Home",r.remove(),t.remove(),e(firebase.database(),o)})),t.parentNode.querySelector("#head").insertBefore(r,t.parentNode.querySelector("h1"))}t.parentNode.querySelector("h1").innerText="Woof";let r=t.querySelector("h4");t.querySelector("h4").remove(),t.querySelector(".content").insertBefore(r,t.querySelector(".interact")),r=t.querySelectorAll(".inline");const a=document.createElement("div");a.classList.add("stats"),Array.from(r).forEach((e=>{let t=Array.from(r).indexOf(e);if(1===t||2===t){let o=e.cloneNode(!0);o.innerText+=(1===t?" Rewoof":2===t?" Like":"")+(1!==Number(o.innerText)?"s":""),a.appendChild(o)}e.remove()})),t.querySelector(".content").insertBefore(a,t.querySelector(".interact")),e(firebase.database(),(e=>{const r=t.querySelector("h3"),n=t.querySelector("h4");let a;for(const t in e)if(`${new Date(e[t].time)}`.slice(4,15)==n.innerText&&e[t].text==r.innerText){a=e[t];break}a.nextWoof&&o(a.nextWoof,!0)}))}))}function o(e,t=!1){for(const o in e)r(e,o,t)}function r(e,o,r){const n=document.createElement("div"),a=document.createElement("span"),l=document.createElement("div"),d=document.createElement("div"),c=document.createElement("h4"),s=document.createElement("h3"),i=document.createElement("div");n.classList.add("woof","border"),a.classList.add("avatar"),l.classList.add("content"),d.classList.add("text"),i.classList.add("interact");for(let t=0;t<4;t++){const r=document.createElement("span"),n=document.createElement("i"),a=document.createElement("p");n.classList.add("click","fas",0===t?"fa-reply":1===t?"fa-retweet":2===t?"fa-heart":3===t?"fa-share-square":""),a.innerText=0===t?e[o].nextWoof?e[o].nextWoof.length:"0":1===t?e[o].rewoof:2===t?e[o].fav:"",a.classList.add("inline"),r.append(n,a),i.appendChild(r)}c.innerText=`${new Date(e[o].time)}`.slice(4,15),s.innerText=e[o].text,d.append(c,s),l.append(d,i),n.append(a,l),r?timeline.appendChild(n):(t(n),timeline.insertBefore(n,timeline.querySelector(".woof.border")))}function n(e,t){const o={...t.querySelectorAll(".woof.border")};for(const t in o)o[t]!==e&&o[t].remove();return 1===Array.from(t.querySelectorAll(".woof.border")).length}return{writeWoof:e=>{let t;return!("object"!=typeof e||!e||(e.time=(new Date).getTime(),t=firebase.database().ref("/Woofs/").push(e).key,e.id=t,firebase.database().ref("/Woofs/"+t).update(e),0))},readWoofs:e,setNextWoof:(e,t)=>!(!e||!e.nextWoof&&null!==e.nextWoof)&&(t&&t.id?(e.nextWoof=t.id,firebase.database().ref("/Woofs/"+e.id).update(e),!0):void 0),addWoofListeners:t,renderAllWoofs:o,renderNewWoof:function(e){let t,o=[];for(const t in e)o.push(e[t]);t=o.length-1,r(o,t)},createWoofHTML:r,removeWoofs:n}})(),t=(()=>{const e=document.createElement("div"),t=document.createElement("span");for(let t=0;t<10;t++){const o=document.createElement("i");o.classList.add("click","fas",0===t?"fa-dog":1===t?"fa-home":2===t?"fa-search":3===t?"fa-bell":4===t?"fa-envelope":5===t?"fa-bookmark":6===t?"fa-file-alt":7===t?"fa-user":8===t?"fa-ellipsis-h":9===t?"avatar":""),e.appendChild(o)}return t.classList.add("avatar"),e.id="menu",e.appendChild(t),e})(),o=(()=>{const e=document.createElement("div"),t=document.createElement("h1");return e.id="head",e.classList.add("border"),t.innerText="Home",e.appendChild(t),e})(),r=(()=>{const e=document.createElement("div"),t=document.createElement("div"),o=document.createElement("div"),r=document.createElement("span"),n=document.createElement("div"),a=document.createElement("input"),l=document.createElement("div"),d=document.createElement("button"),c=document.createElement("div");e.id="timeline",t.id="main",t.classList.add("border"),o.classList.add("woof","woofbox"),r.classList.add("avatar"),n.classList.add("content"),a.type="text",a.placeholder="What's happening?",a.classList.add("text"),a.id="input",l.classList.add("more"),d.innerText="Woof",d.classList.add("click"),c.classList.add("break");for(let e=0;e<5;e++){const t=document.createElement("i");t.classList.add("click","fas",0==e?"fa-camera":1==e?"fa-image":2==e?"fa-chart-bar":3==e?"fa-smile":4==e?"fa-calendar-alt":""),l.appendChild(t)}return l.appendChild(d),n.append(a,l),o.append(r,n),t.append(o,c),e.appendChild(t),e})();(()=>{const n=document.querySelector("#app");e.readWoofs(firebase.database(),e.renderAllWoofs),window.addEventListener("resize",(()=>{t.style.left=r.offsetLeft-72+"px"})),t.querySelector(".fa-home").addEventListener("click",(()=>{window.location.reload()})),r.querySelector("button").addEventListener("click",(()=>{const t=r.querySelector("#input");if(t.value.length>0){const o={text:t.value,fav:0,rewoof:0};e.writeWoof(o)?(t.value="",e.readWoofs(firebase.database(),e.renderNewWoof)):alert("Unable to send woof. Try again in a few seconds.")}})),r.insertBefore(o,r.querySelector("#main")),n.append(t,r),t.style.left=r.offsetLeft-72+"px"})()})();